<!--
SistemaAcademico Policy
-->
<application-policy name="sistemaacademico">
	<authentication>
		<login-module code="org.jboss.security.ClientLoginModule"
			flag="required">
			<module-option name="multi-threaded">true
				</module-option>
		</login-module>
		<login-module code="accessControl.LoginModuleImpl" 
			flag="required">
			<module-option name="dsJndiName">java:/controleacessoDS
				</module-option>
			<module-option name="unauthenticatedIdentity">guest
				</module-option>
			<module-option name="principalClass">
				accessControl.PrincipalImpl</module-option> 
			<module-option name="hashEncoding">hex</module-option> 
			<module-option name="hashAlgorithm">md5</module-option>
			<module-option name="principalsQuery">
				select SENHA from OP_C_A where LOGIN=?
				</module-option>
			<module-option name="rolesQuery">
				select OP_PF.PF_OP_C_A_FK, 'Roles'
				12from OP_C_A, OP_C_A_PF_OP_C_A OP_PF
				where LOGIN=? AND OP_C_A.ID = OP_PF.OP_C_A_FK
			</module-option>
		</login-module>
	</authentication>
</application-policy>
