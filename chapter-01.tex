\chapter{Preparação do Ambiente}

Nesta seção detalharemos o processo de preparação do ambiente de desenvolvimento
com o \texttt{AndroMDA}, onde serão enumeradas as ferramentas utilizadas e seus
respectivos procedimentos de instalação.

Ferramentas necessárias:
\begin{itemize}
  \item Máquina Virtual Java - JDK (Java 6)
  \item JBoss (versão 4.2.3-GA)
  \item Maven (versão 1.0.2) 
  \item Magic Draw (versão 9.5)
  \item Eclipse Indigo (versão 3.7.1)
\end{itemize}

\section{JDK}

É necessário que o \texttt{JDK} esteja instalado no computador. O
download pode ser feito em \texttt{http://java.sun.com/} ou utilizando
algum repositório, como mostra abaixo:

\begin{lstlisting}[language=bash]
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java6-installer
\end{lstlisting}

\section{JBoss}

É necessário que o \texttt{JBoss} esteja instalado no computador. O
\texttt{download} pode ser feito em
\href{http://jbossas.jboss.org/}{http://jbossas.jboss.org/}. Após a
instalação do \texttt{JBoss}, é necessário configurar a variável
\texttt{JBOSS\_HOME}, a qual deve especificar o caminho de instalação do
\texttt{JBoss}. Esse caminho para o \texttt{JBoss} é necessário para a
instalação de aplicações (\texttt{deployment}).

Neste tutorial será considerado que o \texttt{Jboss} estará instalado na pasta
abaixo.

\begin{lstlisting}[language=bash]
/home/<user>/Work/programs/jboss
\end{lstlisting}

O \texttt{Jboss} disponibilizado já está configurado adequadamente para os
exemplos desenvolvidos neste tutorial, caso queira saber como configurar o
\texttt{JBoss} ou modificar a configuração padrão visite o \texttt{apêndice
\ref{jboss-config}}.

\section{Maven}
O
\texttt{Maven}\footnote{\href{http://maven.apache.org/}{http://maven.apache.org/}}
é uma ferramenta de automação e gerenciamento de projetos. O download pode ser
feito através do endereço
\href{http://maven.apache.org/maven-1.x/index.html}{http://maven.apache.org/maven-1.x/index.html}
e sua instalação consiste em descompactar o arquivo obtido em um diretório
local.

A versão compatível é a 1.02. O \texttt{Maven}, durante sua execução, faz acesso
a repositórios remotos, de onde poderão ser obtidos diversos artefatos
necessários às tarefas de automação. Por exemplo bibliotecas (arquivos
\texttt{*.jar}) necessárias para compilação e execução de um projeto podem ser
automaticamente obtidas. Esses artefatos e bibliotecas externos, depêndencias do
projeto, a serem obtidos e incorporados pelo \texttt{Maven} no momento da
geração e compilação, são definidos nos arquivos \texttt{project.xml}. Um mesmo
projeto pode conter vários \texttt{project.xml}, permitindo que possamos definir
dependências diferentes para modulos e pacotes diferentes do nosso sistema de
forma independente, segundo as nossas necessidades.

Para especificar o repositório que o \texttt{Maven} deve acessar é necessário
criar um arquivo, chamado \texttt{build.properties}, no diretório \texttt{home}
do usuário, por exemplo \texttt{/home/<usuario>}.

Abaixo temos exemplos do arquivo build.properties para uso com repositórios
externos, em repositório externo que possui um \texttt{proxy} para acesso à
internet, e com um repositório \texttt{proxy} configurado na rede local.

1. Repositórios remoto quando não é necessário utilizar \texttt{proxy} para
acesso à internet:

\begin{lstlisting}[language=bash]
maven.repo.remote=http://jabot.cos.ufrj.br/repositorio 
\end{lstlisting}

2. Repositórios remoto quando é necessário utilizar \texttt{proxy} para acesso à
internet. No exemplo, o \texttt{IP} do \texttt{proxy} é \texttt{10.0.2.15}:

\begin{lstlisting}[language=bash]
maven.repo.remote=http://jabot.cos.ufrj.br/repositorio
maven.proxy.host=10.0.2.15 maven.proxy.port=8080 
\end{lstlisting}

3. Repositório \texttt{proxy} na rede local. O repositório \texttt{proxy} contém
as bibliotecas \texttt{*.jar} que o \texttt{Maven} poderia requisitar no
repositório remoto na Internet. Esse repositório deverá ser utilizado quando não
é possível ou não é desejável o acesso ao repositório remoto:

\begin{verbatim}
maven.repo.remote=http://<host>:<port> 
\end{verbatim}

Onde \texttt{<host>} é o nome da máquina utilizada como \texttt{proxy} e
\texttt{<port>} é o número da porta do serviço do \texttt{proxy}. Por exemplo:
\texttt{maven.repo.remote=http://146.164.34.92/repositorio/}

É importante observar que o \texttt{Maven}, de acordo com as tarefas executadas,
irá fazer o download dos artefatos necessários e guardá-los em um cache local na
estação de trabalho em um diretório chamado \texttt{.maven} localizado no
diretório \texttt{home} de cada usuário da estação.

Para evitar o acesso a servidores na Internet é possível a instalação de um
\texttt{proxy} específico do \texttt{Maven} na rede local. Neste tutorial de
configuração, não abordaremos a configuração desse \texttt{proxy}.

\section{Varíaveis de Ambiente}

Variáveis de ambiente são uma forma eficiente de influenciar o comportamento das
aplicações rodando em um sistema \texttt{Linux}. A variável \texttt{Lang}, por
exemplo, determina qual o idioma que os programas deverão usar para se comunicar
com o usuário.Se seu \texttt{Linux} tiver sido instalado em inglês, a variável \texttt{Lang}
provavelmente possuirá o valor \texttt{"en\_US.UTF-8" }, por exemplo.

Variáveis de ambiente consistem de nomes os quais possuem valores definidos para
si. Variáveis de ambiente não possuem restrições quanto ao seu formato, tudo o
que for atribuido a ela será salvo como texto, sendo responsabilidade das
aplicações que as usarão interpretar seu significado e seus dados. 

O MDArte usa algumas variáveis de ambiente na sua execução e, para configurá-las
de modo definitivo, adicionaremos no final do arquivo
\texttt{/home/<usuario>/.bashrc} o seguinte código:

\begin{lstlisting}[language=bash]
if [ -f ~/.bashrc_mdarte ]; then
 . ~/.bashrc_mdarte
fi
\end{lstlisting}

O código adicionado fará com que sempre que o sistema operacional for processar
as informações de configuração no arquivo \texttt{.bashrc} ele processe junto
as nossas configurações e variáveis de ambiente, para que não precisemos
configurá-las manualmente sempre que reiniciarmos o sistema. 

Agora, precisamos criar o script que referenciamos no arquivo
\texttt{.bashrc}, e onde ficarão todas as nossas variáveis do ambiente. O
seguinte comando shell faz isso para nós:

\begin{lstlisting}[language=bash]
touch ~/.bashrc_mdarte
\end{lstlisting}
	
Editaremos agora o arquivo \texttt{/home/<usuario>/.bashrc\_mdarte} adicionando
os seguintes valores.

\begin{framed}
	\lstinputlisting[language=sql]{files/bashrc_mdarte}
\end{framed}

Feito isto, será necessário reiniciar a sessão do usuário para essas variáveis
estarem no sistema ou utilizar o seguinte comando abaixo.

\begin{lstlisting}[language=bash]
source ~/.bashrc
\end{lstlisting}

\section{MDArte}

O MDArte, na verdade, não é um aplicativo, mas sim um conjunto de bibliotecas de
classes. Em nosso processo de desenvolvimento, utilizaremos o MDArte como um
plugin do \texttt{Maven}. O \texttt{Maven}, por sua vez, possui um mecanismo
próprio para obtenção de plugins. Através de parâmetros na linha de comando
podemos especificar ao \texttt{Maven} qual plugin queremos instalar e ele se
encarrega de buscar este plugin no(s) repositório(s) para o(s) qual(is) estiver
configurado.

No caso do plugin do MDArte, o seguinte comando deve ser executado para a
instalação (ao copiar o comando, verificar se foi copiado corretamente,
inclusive os hifens):

\begin{lstlisting}[language=bash]
maven plugin:download -DgroupId=andromda
-DartifactId=maven-andromdapp-plugin-coppetec -Dversion=3.1.1.3.4.19-RC8
\end{lstlisting}
	
Após a execução desse comando o \texttt{Maven} terá instalado o plugin do
\texttt{AndroMDA} no cache local do usuário e tarefas referentes ao MDArte
poderão ser executadas através do \texttt{Maven}.

Eventualmente, dependendo das tarefas executadas, o \texttt{Maven} poderá buscar
outros artefatos nos repositórios, contudo isso será feito de forma transparente
e automática.

\section{MagicDraw}

O download do \texttt{MagicDraw} pode ser feito em
\texttt{http://www.magicdraw.com}.

O \texttt{MagicDraw} é uma ferramenta para modelagem em \texttt{UML} e é
recomendada para uso com o MDArte devido a seu suporte a diagramas de atividade,
utilizados pelo cartucho \texttt{BPM4Struts}. Ainda, para que os modelos sejam
corretamente utilizados pelo MDArte eles deverão conter estereótipos
específicos, disponíveis através de um profile fornecido com o MDArte, que será
mostrado com mais detalhes na seção “Iniciando o projeto no \texttt{MagicDraw}”.

\section{Eclipse}

O download do Eclipse pode ser feito em \texttt{http://www.eclipse.org/}. 

Durante a geração de um projeto, o MDArte gerará automaticamente os arquivos de
configuração \texttt{.project} e \texttt{.classpath} de um projeto
\texttt{Eclipse}. Esses arquivos podem ser usados diretamente para importação do
projeto ao \texttt{Eclipse}. O \texttt{.classpath} é o arquivo onde será
indicado as bibliotecas para o \texttt{eclipse} que serão utilizados pelo
projeto. Assim, o eclipse saberá completar as informações automaticamente. Já o
\texttt{.project} é uma descrição das opções do projeto.

Citation of Einstein paper~\cite{Einstein}.